<!doctype html>
<html>
    <head>
        <!-- META Tags -->
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>代码签名证书的使用 | 风中的木偶</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- SEO -->
        <meta name="author" content="风中的木偶">
        <meta name="description" content="">
        <meta name="keywords" content="木偶笔记,个人技术博客,IT技术笔记,博客,个人网站,风中的木偶,木偶">
        <meta name="twitter:card" value="summary">
                                                                <meta property="og:title" content="风中的木偶个人博客" />
                                                                <meta property="og:type" content="article" />
                                                                <meta property="og:url" content="https://wangmaolin.net" />
                                                                                            
        <!-- CSS -->
        <link rel="stylesheet" href="../../vendor/binarytorch/larecipe/assets/css/app.css">

        
        <!-- FontAwesome -->
        <link rel="stylesheet" href="../../vendor/binarytorch/larecipe/assets/css/font-awesome.css">
                    <link rel="stylesheet" href="../../vendor/binarytorch/larecipe/assets/css/font-awesome-v4-shims.css">
        
        <!-- Dynamic Colors -->
        <style>
    :root {
        --primary: #787AF6;
        --secondary: #2b9cf2;
    }

    :not(pre)>code[class*=language-], pre[class*=language-] {
        border-top: 3px solid #787AF6;
    }
    
    .bg-gradient-primary {
        background: linear-gradient(87deg, #787AF6 0, #2b9cf2 100%) !important;
    }

    [v-cloak] > * { 
        display: none; 
    }
    
    [v-cloak]::before { 
        content: " ";
        position: absolute;
        width: 100%;
        height: 100%;
        background-color: #F2F6FA;
    }
</style>
        <!-- CSRF Token -->
        <meta name="csrf-token" content="Pahvyn05xLeGT7ZyAH8zdtrdERAneaW7crP5Dk0P">

        
    </head>
    <body>
        <div id="app" v-cloak>
            <div class="fixed pin-t pin-x z-40">
    <div class="bg-gradient-primary text-white h-1"></div>

    <nav class="flex items-center justify-between text-black bg-navbar shadow-xs h-16">
        <div class="flex items-center flex-no-shrink">
            <a href="../../index.html" class="flex items-center flex-no-shrink text-black mx-4">
                
                <p class="inline-block font-semibold mx-1 text-grey-dark">
                    风中的木偶
                </p>
            </a>

            <div class="switch">
                <input type="checkbox" name="1" id="1" v-model="sidebar" class="switch-checkbox"/>
                <label class="switch-label" for="1"></label>
            </div>
        </div>

        <div class="hidden lg:flex items-center justify-end pr-4">
            <div class="relative">
                <form action="https://wangmaolin.net/search" onsubmit="return validateForm()" class="form-search">
                    <input id="search-input" name="q" type="text" placeholder="Search" class="bg-gray-100 appearance-none border-2 border-gray-200 rounded py-2 px-4
         text-gray-800 leading-tight focus:outline-none focus:bg-white focus:border-gray-500">
                </form>
            </div>
        </div>

        <div class="block mx-4 flex items-center">
                        
            
            
            
            

            
            <larecipe-dropdown>
                <larecipe-button type="primary" class="flex">
                    Windows <i class="mx-1 fa fa-angle-down"></i>
                </larecipe-button>

                <template slot="list">
                    <ul class="list-reset" style="height: 800px;width: 200px">
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../AI/overview.html">AI</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../APP/overview.html">APP</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../CSS/overview.html">CSS</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../Docker/overview.html">Docker</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../ELK/overview.html">ELK</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../Git/overview.html">Git</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../Go语言/overview.html">Go语言</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../Laravel/overview.html">Laravel</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../Linux/overview.html">Linux</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../Linux&#32;服务器配置/overview.html">Linux 服务器配置</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../Mac/overview.html">Mac</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../MongoDB/overview.html">MongoDB</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../Mqtt/overview.html">Mqtt</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../MySQL/overview.html">MySQL</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../Nginx/overview.html">Nginx</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../PHP/overview.html">PHP</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../Protobuf/overview.html">Protobuf</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../Python/overview.html">Python</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../SEO/overview.html">SEO</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../Vue&#32;教程/overview.html">Vue 教程</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="overview.html">Windows</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../webman/overview.html">webman</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../一无所有到财富自由/overview.html">一无所有到财富自由</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../云服务/overview.html">云服务</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../产品/overview.html">产品</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../元宇宙/overview.html">元宇宙</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../前端/overview.html">前端</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../合伙的本质/overview.html">合伙的本质</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../商业/overview.html">商业</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../大数据/overview.html">大数据</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../天机38局/overview.html">天机38局</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../开源项目/overview.html">开源项目</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../微信/overview.html">微信</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../控糖革命/overview.html">控糖革命</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../搜索/overview.html">搜索</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../支付/overview.html">支付</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../智慧人生/overview.html">智慧人生</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../架构/overview.html">架构</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../游戏开发/overview.html">游戏开发</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../算法/overview.html">算法</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../缓存/overview.html">缓存</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../网络/overview.html">网络</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../自媒体/overview.html">自媒体</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../菜谱/overview.html">菜谱</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../设计模式/overview.html">设计模式</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../资源/overview.html">资源</a>
                            </li>
                                                    <li class="py-2 hover:bg-grey-lightest">
                                <a class="px-6 text-grey-darkest"
                                   href="../软件工具/overview.html">软件工具</a>
                            </li>
                                            </ul>
                </template>
            </larecipe-dropdown>
            

                    </div>
    </nav>
</div>

            
            <div>
	<div class="sidebar" :class="[{'is-hidden': ! sidebar}]">
    <ul>
<li>
<h2>APP</h2>
<ul>
<li id="blog323"><a href="x2ev8pg9or.html#blog323">Windows 常用软件推荐</a>
</ul>
</li>
<li>
<h2>wsl</h2>
<ul>
<li id="blog384"><a href="jwnex4rvxd.html#blog384">Windows 下 wsl 的备份与还原</a>
<li id="blog385"><a href="4oxy7j7y98.html#blog385">WSL 文件权限问题</a>
</ul>
</li>
<li>
<h2>软件开发</h2>
<ul>
<li id="blog831"><a href="kl9no2dvz4.html#blog831">代码签名证书的使用</a>
</ul>
</li>
</ul>
</div>

<style>
    #cnzz_stat_icon_1280630928
    {
        display: none;
    }
</style>

<script src="../../vendor/binarytorch/larecipe/assets/js/jquery.min.js"></script>
<script src="../../modules/blog/js/detail.js"></script>

<script type="text/javascript">
    $(function () {
        var cid = 'kl9no2dvz4.html';
        if (!checkView(cid)) {
            $.get('https://wangmaolin.net/api/blog/addView/article/kl9no2dvz4.html', function (data, status) {
                addView('kl9no2dvz4.html')
            });
        }
    });
</script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7c12b9716af39eb368cff4a19aa89393";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7125202304422722"
     crossorigin="anonymous"></script>
	
	<div class="documentation is-dark" :class="{'expanded': ! sidebar}">
		<h1>代码签名证书的使用</h1><ul>
<li><a href="kl9no2dvz4.html#db0db2db908781e7d6314a57dee51af2">windows 安装包分发的坑</a></li>
<li><a href="kl9no2dvz4.html#b2151f2f68c8721418b0dcc5bdd1642c">代码签名证书的作用</a>
<ul>
<li><a href="kl9no2dvz4.html#ca30ea2b1b32ca46abdf7f0ca85c47e9">1. 防篡改验证</a></li>
<li><a href="kl9no2dvz4.html#2f8fce784645befd26b6691194a09d69">2. 显示开发者身份</a></li>
<li><a href="kl9no2dvz4.html#5eaa5fc9c60c1487cbfb5f77c016687e">3. 减少系统警告</a></li>
<li><a href="kl9no2dvz4.html#b650d0d91dd7f9508a4e3cbc36e4458e">4. 提升安全软件兼容性</a></li>
<li><a href="kl9no2dvz4.html#7706a1fbffbd137211294cbee21e0ac8">5. 增强品牌信誉和用户信任</a></li>
<li><a href="kl9no2dvz4.html#b5308c026522fd6d5b048dcefb41563b">6. 满足平台发布要求</a></li>
<li><a href="kl9no2dvz4.html#8c9d507e0cf190392406aac2d4558ea9">总结：</a></li>
</ul></li>
<li><a href="kl9no2dvz4.html#583c5aa76f4bbc2af45f0e0a1e363947">签名申请</a></li>
<li><a href="kl9no2dvz4.html#54c84f64a98d42fa6fa3173afc142a29">签名流程</a>
<ul>
<li><a href="kl9no2dvz4.html#96b8d2c96e090b873df0786aab006084">1、准备</a></li>
<li><a href="kl9no2dvz4.html#527262aeece3c6616c6674b70d194a00">2、安装签名工具 SignTool（推荐）</a></li>
<li><a href="kl9no2dvz4.html#47ea42be57dee505da9ade787017db0c">3、插入 USB Token 并导入证书（如果尚未完成）</a></li>
<li><a href="kl9no2dvz4.html#ed27b2d9bdb2a98dc410005cb38206b7">4、签名命令（使用 SignTool）</a></li>
<li><a href="kl9no2dvz4.html#d410876d65b8d949e11dbeb3616bcc5e">5、验证签名是否成功</a></li>
<li><a href="kl9no2dvz4.html#46916e3c05b8f8af6a92f0c79ab85d0d">6、注意事项</a></li>
</ul></li>
<li><a href="kl9no2dvz4.html#ce54268433769e0d5d86985bd9cec928">使用批处理脚本自动签名</a>
<ul>
<li><a href="kl9no2dvz4.html#d0a7ddaf8ded6828a830048cdcfa2433">签名脚本内容（Windows 批处理文件）</a></li>
<li><a href="kl9no2dvz4.html#41ed0a82162421de6d349aa3ee0df970">使用说明：</a></li>
</ul></li>
</ul><h2 id="db0db2db908781e7d6314a57dee51af2">windows 安装包分发的坑</h2>
<p>我们在开发完 windows 软件打包为 .exe 进行分发时，会遇到三个坑</p>
<p>1、用户通过浏览器下载 exe 安装包时会被拦截</p>
<p><img src="../../storage/images/2025/05/I3fn3eNvJ44YHqbdCBgJO65nYxDtEVaDBUI2urOM.png" alt="" /></p>
<p>2、点击 exe 文件安装时会被警告提醒或被杀毒软件误报为病毒</p>
<p><img src="../../storage/images/2025/05/woIotzEwCuDYt4EebIc1GvFXflIidnBPjyztLf5V.png" alt="" /></p>
<p><img src="../../storage/images/2025/05/gcEPG4K5TTpm0AJXfZCX5bJ2FxEm8ocWvK6FSl6g.png" alt="" /></p>
<p>3、安装后点击运行电脑会报风险应用</p>
<p><img src="../../storage/images/2025/05/XsT9eoVgxdlwrsT6RU3iFZ2dxbgnF28fDbRRcRNk.png" alt="" /></p>
<h2 id="b2151f2f68c8721418b0dcc5bdd1642c">代码签名证书的作用</h2>
<p>使用<strong>代码签名证书</strong>（Code Signing Certificate）对 <code>.exe</code> 安装包进行签名，就是为了解决以上几个关键问题，提高软件的可信度、安全性和用户体验：</p>
<hr />
<h3 id="ca30ea2b1b32ca46abdf7f0ca85c47e9">1. <strong>防篡改验证</strong></h3>
<p>签名后的 <code>.exe</code> 文件如果被篡改（如恶意注入木马、病毒），签名就会失效，操作系统和安全软件会提示用户该文件可能不安全。</p>
<blockquote>
<p><strong>作用</strong>：确保下载和执行的安装包与开发者发布的一致，未被第三方修改。</p>
</blockquote>
<hr />
<h3 id="2f8fce784645befd26b6691194a09d69">2. <strong>显示开发者身份</strong></h3>
<p>签名证书中包含了开发者或公司的合法身份信息（比如公司名称），安装时系统会显示：</p>
<pre><code class="   language-php">发布者：XXX公司</code></pre>
<p>而不是：</p>
<pre><code class="   language-php">发布者：未知</code></pre>
<p><img src="../../storage/images/2025/05/6DRbkConDO7UMIS07auO0Idi6vm2xv4Uryzy3qyH.png" alt="" /></p>
<blockquote>
<p><strong>作用</strong>：建立信任，减少用户在看到“未知发布者”时取消安装的情况。</p>
</blockquote>
<hr />
<h3 id="5eaa5fc9c60c1487cbfb5f77c016687e">3. <strong>减少系统警告</strong></h3>
<p>未签名的 <code>.exe</code> 在 Windows 上运行时，特别是在 Windows 10/11 中，用户会看到如下警告：</p>
<pre><code class="   language-php">Windows 保护你的电脑
SmartScreen 阻止了一个未识别的应用启动……</code></pre>
<p>而签名文件可以显著减少这种阻拦提示，尤其是在配合<strong>EV代码签名证书</strong>时，可以直接绕过 SmartScreen 的拦截。</p>
<hr />
<h3 id="b650d0d91dd7f9508a4e3cbc36e4458e">4. <strong>提升安全软件兼容性</strong></h3>
<p>杀毒软件和防火墙会优先信任签名文件。未签名的程序更容易被拦截、隔离或误报为病毒。</p>
<hr />
<h3 id="7706a1fbffbd137211294cbee21e0ac8">5. <strong>增强品牌信誉和用户信任</strong></h3>
<p>签名安装包表明你是一个有信誉的开发者或公司，用户在安装时更容易信任你的软件，有助于提升转化率和品牌形象。</p>
<hr />
<h3 id="b5308c026522fd6d5b048dcefb41563b">6. <strong>满足平台发布要求</strong></h3>
<p>一些平台（如 Microsoft、某些企业级分发平台）要求 <code>.exe</code> 必须签名才能被接受或正常安装。</p>
<hr />
<h3 id="8c9d507e0cf190392406aac2d4558ea9">总结：</h3>
<table>
<thead>
<tr>
<th>问题/需求</th>
<th>是否可通过代码签名解决</th>
</tr>
</thead>
<tbody>
<tr>
<td>防止文件被篡改</td>
<td>✅ 是</td>
</tr>
<tr>
<td>显示合法发布者身份</td>
<td>✅ 是</td>
</tr>
<tr>
<td>减少 Windows SmartScreen 拦截</td>
<td>✅ 是（尤其是 EV 签名）</td>
</tr>
<tr>
<td>减少杀毒软件误报</td>
<td>✅ 是</td>
</tr>
<tr>
<td>增强用户信任</td>
<td>✅ 是</td>
</tr>
<tr>
<td>满足某些平台发布要求</td>
<td>✅ 是</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="583c5aa76f4bbc2af45f0e0a1e363947">签名申请</h2>
<p>建议申请 EV 证书，普通代码签名证书对 SmartScreen 的效果有限，新安装包可能仍提示不安全，需要累积信誉后才能被认为是安全的安装包。</p>
<p>若希望直接绕过 SmartScreen 拦截，建议使用EV 代码签名证书（Extended Validation Code Signing Certificate）。</p>
<p>签名申请平台：</p>
<p><a href="https://www.anxinssl.com/code-signing-certificate/">安信证书</a></p>
<p><a href="https://www.ihuandu.com/codesigning.html">环度网信</a></p>
<p><a href="https://www.trustasia.com/ssl/trustasia/code-signing">TrustAsia</a></p>
<h2 id="54c84f64a98d42fa6fa3173afc142a29">签名流程</h2>
<p>购买 EV 代码签名证书后，给 <code>.exe</code> 安装包进行签名的流程大致如下。</p>
<hr />
<h3 id="96b8d2c96e090b873df0786aab006084">1、准备</h3>
<table>
<thead>
<tr>
<th>项目</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>EV 代码签名证书</td>
<td>已购买的 EV 证书（如 Certum EV）</td>
</tr>
<tr>
<td>USB 令牌（Token）</td>
<td>EV 证书强制使用硬件加密设备（证书私钥存于 USB 令牌中）</td>
</tr>
<tr>
<td>Microsoft SignTool 工具</td>
<td>Windows SDK 自带，也可单独下载</td>
</tr>
<tr>
<td>已编译的 <code>.exe</code> 文件</td>
<td>你要签名的安装包或应用程序可执行文件</td>
</tr>
<tr>
<td>时间戳服务器地址</td>
<td>用于防止签名因时间过期失效（Certum 常用时间戳地址见下）</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="527262aeece3c6616c6674b70d194a00">2、安装签名工具 SignTool（推荐）</h3>
<p>SignTool 是微软官方签名工具，免费、安全：</p>
<ul>
<li>安装 <a href="https://developer.microsoft.com/en-us/windows/downloads/sdk-archive/">Windows 10 SDK</a></li>
<li>安装完成后，<code>signtool.exe</code> 位于路径：</li>
</ul>
<pre><code class="   language-php">C:\Program Files (x86)\Windows Kits\10\bin\&lt;version&gt;\x64\</code></pre>
<hr />
<h3 id="47ea42be57dee505da9ade787017db0c">3、插入 USB Token 并导入证书（如果尚未完成）</h3>
<ul>
<li>插入 EV 证书的 USB Token（比如 Certum 的 SafeNet eToken）</li>
<li>安装配套驱动程序（通常证书提供商提供）</li>
<li>证书将自动注册到 Windows 证书存储中，路径为：</li>
</ul>
<pre><code class="   language-php">证书管理器 &gt; 个人 &gt; 证书（可使用 certmgr.msc 打开）</code></pre>
<hr />
<h3 id="ed27b2d9bdb2a98dc410005cb38206b7">4、签名命令（使用 SignTool）</h3>
<p>这是标准签名命令（含时间戳）：</p>
<pre><code class="language-bash">signtool sign /tr http://timestamp.certum.pl /td sha256 /fd sha256 /n "你的公司名称" "your_app.exe"</code></pre>
<p><code>参数说明：</code></p>
<ul>
<li><code>/n "你的公司名称"</code>：签名证书中的发布者名称（如：ABC Technology Co., Ltd.）</li>
<li><code>/fd sha256</code>：使用 SHA256 算法（现在已强制要求）</li>
<li><code>/td sha256</code>：时间戳摘要算法（推荐 SHA256）</li>
<li><code>/tr http://timestamp.certum.pl</code>：Certum 时间戳服务器（也可以用其他如 <a href="http://timestamp.digicert.com">DigiCert 的：</a>）</li>
<li><code>your_app.exe</code>：你的可执行文件路径</li>
</ul>
<p><code>示例：</code></p>
<pre><code class="language-bash">signtool sign /tr http://timestamp.certum.pl /td sha256 /fd sha256 /n "MySoftware Co., Ltd." myinstaller.exe</code></pre>
<hr />
<h3 id="d410876d65b8d949e11dbeb3616bcc5e">5、验证签名是否成功</h3>
<p>运行以下命令来检查签名状态：</p>
<pre><code class="language-bash">signtool verify /pa /v myinstaller.exe</code></pre>
<p>或者右键 <code>.exe</code> → “属性” → “数字签名” 标签页 查看。</p>
<hr />
<h3 id="46916e3c05b8f8af6a92f0c79ab85d0d">6、注意事项</h3>
<table>
<thead>
<tr>
<th>项目</th>
<th>注意点</th>
</tr>
</thead>
<tbody>
<tr>
<td>⚠️ Windows SmartScreen</td>
<td>仅 EV 证书才能立即信任，普通证书需要信誉积累</td>
</tr>
<tr>
<td>🔐 私钥安全</td>
<td>EV 证书私钥<strong>不可导出</strong>，只能通过 USB Token 使用</td>
</tr>
<tr>
<td>🔄 多次签名</td>
<td>若你对文件做了修改或重打包，需要重新签名</td>
</tr>
<tr>
<td>🕓 时间戳服务器</td>
<td>一定要加 <code>/tr</code> 和 <code>/td</code> 否则签名会因过期而无效</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="ce54268433769e0d5d86985bd9cec928">使用批处理脚本自动签名</h2>
<h3 id="d0a7ddaf8ded6828a830048cdcfa2433">签名脚本内容（Windows 批处理文件）</h3>
<p>将以下内容复制到一个 <code>.bat</code> 文件中，例如保存为 <code>sign_myinstall.bat</code>：</p>
<pre><code class="language-bash">@echo off
setlocal

:: 设置 SignTool 路径（请根据你安装的 SDK 版本修改）
set SIGNTOOL="C:\Program Files (x86)\Windows Kits\10\bin\x64\signtool.exe"

:: 要签名的文件
set TARGET_FILE=myinstall.exe

:: 发布者名称（填写你 EV 证书中的公司名称）
set PUBLISHER="你的公司名称或个人名称"

:: Certum 时间戳服务器
set TIMESTAMP=http://timestamp.certum.pl

echo 正在为 %TARGET_FILE% 进行数字签名...

%SIGNTOOL% sign /n %PUBLISHER% /tr %TIMESTAMP% /td sha256 /fd sha256 %TARGET_FILE%

if %errorlevel% neq 0 (
    echo 签名失败！请检查证书是否正确安装和 USB Token 是否插入。
) else (
    echo 签名成功！
)

pause
endlocal</code></pre>
<hr />
<h3 id="41ed0a82162421de6d349aa3ee0df970">使用说明：</h3>
<ol>
<li>将 <code>myinstall.exe</code> 和这个 <code>.bat</code> 文件放在同一个目录下；</li>
<li>修改以下参数：
<ul>
<li><code>SIGNTOOL</code> 路径（如需修改 SDK 版本）；</li>
<li><code>PUBLISHER</code> 为你的 EV 证书中的<strong>真实公司名称</strong>；</li>
</ul></li>
<li>双击运行这个 <code>.bat</code> 文件即可签名；</li>
<li>签名后可通过右键 → “属性” → “数字签名” 查看是否成功。</li>
</ol><h4 style="text-align:left;line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size:14px;font-weight:bold;margin:2em 8px 0.5em;color:rgba(250, 81, 81, 1)">引用链接</h4><p style="text-align:left;line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size:80%;margin:0.5em 8px;color:#3f3f3f"><code style="font-size: 90%; opacity: 0.6;">[1]</code> 安信证书: <i><a href="https://www.anxinssl.com/code-signing-certificate/" target="_blank">https://www.anxinssl.com/code-signing-certificate/</a></i><br><code style="font-size: 90%; opacity: 0.6;">[2]</code> 环度网信: <i><a href="https://www.ihuandu.com/codesigning.html" target="_blank">https://www.ihuandu.com/codesigning.html</a></i><br><code style="font-size: 90%; opacity: 0.6;">[3]</code> TrustAsia: <i><a href="https://www.trustasia.com/ssl/trustasia/code-signing" target="_blank">https://www.trustasia.com/ssl/trustasia/code-signing</a></i><br><code style="font-size: 90%; opacity: 0.6;">[4]</code> Windows 10 SDK: <i><a href="https://developer.microsoft.com/en-us/windows/downloads/sdk-archive/" target="_blank">https://developer.microsoft.com/en-us/windows/downloads/sdk-archive/</a></i><br><code style="font-size: 90%; opacity: 0.6;">[5]</code> DigiCert 的：: <i><a href="http://timestamp.digicert.com" target="_blank">http://timestamp.digicert.com</a></i><br></p>
			</div>
</div>

            <larecipe-back-to-top></larecipe-back-to-top>
        </div>


        <script>
            window.config = [];
        </script>

        <script type="text/javascript">
            if(localStorage.getItem('larecipeSidebar') == null) {
                localStorage.setItem('larecipeSidebar', !! 1);
            }
        </script>

        <script src="../../vendor/binarytorch/larecipe/assets/js/app.js"></script>

        <script>
            window.LaRecipe = new CreateLarecipe(config)
        </script>

        <!-- Google Analytics -->
                <!-- /Google Analytics -->

        
        <script>
            LaRecipe.run()
        </script>
    </body>
</html>
